<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>hls-peerify</title>
</head>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script src="../dist/hls-peerify.js"></script>
<body>
<video id="video" controls></video>
<script>

    console.log(JSON.stringify(HlsPeerify.uaParserResult, null, 2));

    if(Hls.isSupported()) {
        var video = document.getElementById('video');

        var hlsjsConfig = {
//        debug: true,
//      pLoader : pLoader,
        }

        var p2pConfig = {debug: true};

        var hls = new Hls(hlsjsConfig);

        hls.loadSource('https://video-dev.github.io/streams/x36xhzz/x36xhzz.m3u8');
//        hls.loadSource('https://video-dev.github.io/streams/test_001/stream.m3u8?a=123');
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED,function(event, data) {

            video.play();
        });

        hls.on(Hls.Events.ERROR, function (event, data) {
            var errorType = data.type;
            var errorDetails = data.details;
            var errorFatal = data.fatal;
            console.warn('error details:'+errorDetails);
//      switch(data.details) {
//        case hls.ErrorDetails.FRAG_LOAD_ERROR:
//          // ....
//          break;
//        default:
//          break;
//      }
        });

        new HlsPeerify(hls, p2pConfig);

    }
</script>
</body>
</html>